# How the `django-admin` script is generated and how it connects to `__main__.py`

---

In modern Django, the `django-admin` script is **not explicitly defined in `setup.py`**. Instead, it is generated automatically by `setuptools` using the `console_scripts` entry point mechanism. This is a more modern and flexible approach than using the `scripts` argument.

see [setup-and-setuptools.md](setup-and-setuptools.md) about `setup.py`

---

# Entry Points in `setup.cfg`

Django uses a `setup.cfg` file to define its configuration for `setuptools`. This file includes an `entry_points` section that defines the `django-admin` console script. Hereâ€™s the relevant part of `setup.cfg`:

```ini
[options.entry_points]
console_scripts =
    django-admin = django.core.management:execute_from_command_line
```

This tells `setuptools` to create a `django-admin` script that calls the `execute_from_command_line` function in `django.core.management`.

---

# How Entry Points Work

When you install Django using `pip`, `setuptools` reads the `entry_points` configuration in `setup.cfg` and generates the `django-admin` script. This script is placed in your Python environment's `bin` (or `Scripts`) directory.

The generated script is a thin **wrapper** that looks like this:

```python
#!/path/to/python
from django.core.management import execute_from_command_line
execute_from_command_line()
```

This is functionally equivalent to running `python -m django`.

---

# The Role of `__main__.py`

The `__main__.py` file in Django's root directory allows Django to be run as a module (`python -m django`). It contains:

```python
from django.core import management

if __name__ == "__main__":
    management.execute_from_command_line()
```

This is the same logic as the `django-admin` script. The difference is that `__main__.py` is used when running Django as a module, while the `django-admin` script is a standalone executable.

---

# Why This Design?

This design provides flexibility:

-   **As a Module**: You can run Django as a module (`python -m django`) without needing a separate script.
-   **As a Script**: The `django-admin` script is a convenient way to interact with Django from the command line.

Both approaches ultimately call `django.core.management.execute_from_command_line()` to handle commands.

---

# How to See the Generated `django-admin` Script

After installing Django, you can locate the `django-admin` script in your Python environment's `bin` (or `Scripts`) directory. For example:

-   **Linux/macOS**: `venv/bin/django-admin`
-   **Windows**: `venv\Scripts\django-admin.exe`

The content of the script will look something like this:

```python
#!/path/to/python
from django.core.management import execute_from_command_line
execute_from_command_line()
```

---

# Summary

-   The `django-admin` script is generated by `setuptools` using the `console_scripts` entry point defined in `setup.cfg`.
-   The `__main__.py` file allows Django to be run as a module (`python -m django`).
-   Both the `django-admin` script and `__main__.py` call `django.core.management.execute_from_command_line()` to handle commands.

This design ensures that Django can be used both as a module and as a standalone script, providing flexibility for developers.

-   [ ] how `setup.py` work
-   [ ] how does the more modern approach work and how to use it for packaging and distritutions.
-   [ ] how does packaging and distributions work in Python
